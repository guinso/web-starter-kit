angular.module('MyApp').directive('accountSearch',function(){return{restrict:'A',scope:{guig:'=',title:'@'},templateUrl:'partials/account-search.html'}}).factory('$coms',['$resource','$util','$timeout',function($resource,$util){this.accountSearch=function(id,selectCallback,failCallback,modalClosedCallback){var x={items:[],modalId:id,selectedItem:null,query:{pgIndex:1,pgSize:10,},};x.reload=function(){$util.countAndQuery('api/account-cnt','api/account',x.query,function(z){x.items=z;},function(response){if(failCallback)
failCallback(response);});};x.callSearch=function(){x.selectedItem=null;$('#'+x.modalId).modal('show');x.reload();};x.search=function(){$('#'+x.modalId).on('hidden.bs.modal',function(e){if(modalClosedCallback){modalClosedCallback(x.selectedItem);}});if(selectCallback){selectCallback(x.selectedItem);}
$('#'+x.modalId).modal('hide');}
return x;};return this;}]);angular.module('MyApp').controller('LoginCtrl',function($scope,$resource,$location,$window){$scope.usr={username:'',password:'',errorMsg:''};$scope.usr.checkKey=function(event){if(event.which==13){$scope.usr.login();}}
$scope.usr.login=function(){$resource('api/login').save({username:$scope.usr.username,pwd:$scope.usr.password},function(){if($scope.navigation.stackUrl){var url=$scope.navigation.stackUrl;$scope.navigation.stackUrl='';$location.path(url);}else{$location.path('#');}},function(){$scope.usr.errorMsg='Login failed, please check username and password.';});};$scope.navigation.plainPage=true;});